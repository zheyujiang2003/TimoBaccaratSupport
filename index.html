<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timo百家輔助</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            background-color: #f5f5f7; 
            color: #333; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 20px;
            text-rendering: optimizeLegibility;
        }
        h1 { 
            font-size: 2.5em; 
            margin-bottom: 20px; 
            color: #333; 
            text-align: center;
            font-weight: 600;
            letter-spacing: -0.5px;
        }
        
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            width: 100%;
            max-width: 600px;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 20px;
            flex-direction: column;
        }

        .row {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }

        .left-panel, .right-panel {
            flex: 1;
            padding: 10px;
        }

        .left-panel h2, .right-panel h2 {
            font-size: 1.2em;
            color: #333;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            font-size: 0.9em;
            color: #555;
            font-weight: 500;
            display: block;
            margin-bottom: 5px;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            border: 1px solid #ddd;
            border-radius: 10px;
            outline: none;
            transition: all 0.3s ease;
            font-weight: 400;
        }

        input[type="text"]:focus {
            border-color: #0071e3;
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.15);
        }

        button {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            margin-top: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .calculate-btn { background-color: #0071e3; }
        .calculate-btn:hover { background-color: #005bb5; }

        .clear-btn { background-color: #d9534f; }
        .clear-btn:hover { background-color: #c9302c; }

        .expectation, .prediction-result {
            padding: 15px;
            border-radius: 10px;
            background-color: #f9f9f9;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            font-size: 1.1em;
            color: #333;
            font-weight: 500;
        }

        .accuracy {
            margin-top: 10px;
            padding: 10px;
            border-radius: 10px;
            background-color: #e0f7fa;
            font-size: 1em;
            color: #00796b;
            font-weight: 500;
            text-align: center;
        }
    </style>
</head>
<body>

<h1>Timo百家輔助</h1>

<div class="container">
    <div class="row">
        <div class="left-panel">
            <h2>輸入區</h2>
            
            <div class="input-group">
                <label for="player">閒牌值（依序輸入三張牌點數）：</label>
                <input type="text" id="player" maxlength="3" placeholder="例如：789 或 780">
            </div>

            <div class="input-group">
                <label for="banker">莊牌值（依序輸入三張牌點數）：</label>
                <input type="text" id="banker" maxlength="3" placeholder="例如：345 或 340">
            </div>

            <button class="calculate-btn" onclick="calculateResult()">計算結果</button>
            <button class="clear-btn" onclick="clearAll()">消除全部</button>
        </div>

        <div class="right-panel">
            <h2>預測區</h2>
            <div class="expectation">
                <strong>優勢判斷：</strong>
                <div id="predictionResult">等待輸入...</div>
            </div>
            <div class="accuracy">
                <div>目前預測準確率：<span id="accuracyRate">0%</span></div>
            </div>
        </div>
    </div>
</div>

<script>
    // CP 計分表
    function cardToCP(card) {
        const cpMap = {
            'A': -5, '2': -4, '3': -3, '4': -2,
            '5': 1, '6': 2, '7': 3, '8': 0, '9': 5,
            '10': 0, 'J': 0, 'Q': 0, 'K': 0
        };
        return cpMap[card.toUpperCase()] || 0;
    }

    // AP 權重表
    const apMap = {
        0: 0.5, 1: 0.4, 2: 0.3, 3: 0.3, 4: 0.1,
        5: 0.2, 6: 0.3, 7: 0.3, 8: 0.5, 9: 0.1
    };

    let totalPredictions = 0;
    let correctPredictions = 0;

    function calculateResult() {
        const playerInput = document.getElementById('player').value.padEnd(3, '0');
        const bankerInput = document.getElementById('banker').value.padEnd(3, '0');

        // 確保輸入為合法的數字或字母
        if (!/^[0-9AJQK]+$/.test(playerInput) || !/^[0-9AJQK]+$/.test(bankerInput) || playerInput.length !== 3 || bankerInput.length !== 3) {
            alert("請確保輸入的牌點數為三位數字或字母（A、J、Q、K），無補牌時請輸入0。");
            return;
        }

        // 計算 CP 值
        const playerCP = cardToCP(playerInput[0]) + cardToCP(playerInput[1]) + cardToCP(playerInput[2]);
        const bankerCP = cardToCP(bankerInput[0]) + cardToCP(bankerInput[1]) + cardToCP(bankerInput[2]);

        // 獲取 AP 值
        const playerAP = apMap[Math.abs(playerCP)] || 0.1;
        const bankerAP = apMap[Math.abs(bankerCP)] || 0.1;

        // 計算優勢
        const playerAdvantage = playerCP * playerAP;
        const bankerAdvantage = bankerCP * bankerAP;

        // 推薦下注
        let recommendation;
        let predictedOutcome;

        if (playerAdvantage > bankerAdvantage) {
            recommendation = "建議下注：閒家";
            predictedOutcome = "閒";
        } else if (bankerAdvantage > playerAdvantage) {
            recommendation = "建議下注：莊家";
            predictedOutcome = "莊";
        } else {
            recommendation = "建議看一把";
            predictedOutcome = "看一把";
        }

        document.getElementById("predictionResult").innerText = recommendation;

        // 模擬真實結果（這裡需要用戶輸入真實結果，這裡以隨機結果作為示例）
        const actualOutcome = Math.random() < 0.5 ? "閒" : "莊";

        // 更新預測準確率
        totalPredictions++;
        if (predictedOutcome === actualOutcome) {
            correctPredictions++;
        }
        updateAccuracy();

        clearInputs();
    }

    function updateAccuracy() {
        const accuracyRate = ((correctPredictions / totalPredictions) * 100).toFixed(2);
        document.getElementById("accuracyRate").innerText = `${accuracyRate}%`;
    }

    function clearInputs() {
        document.getElementById('player').value = "";
        document.getElementById('banker').value = "";
    }

    function clearAll() {
        document.getElementById('player').value = "";
        document.getElementById('banker').value = "";
        document.getElementById("predictionResult").innerText = "等待輸入...";
        totalPredictions = 0;
        correctPredictions = 0;
        updateAccuracy();
    }
</script>

</body>
</html>